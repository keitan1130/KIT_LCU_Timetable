これは、指定された大学の時間割カレンダーページに「カレンダー出力」ボタンを追加し、クリックされた際に情報を抽出するためのコンテンツスクリプト（content.ts）です。
前のと分けるためフォルダを分けて良い

1. 概要
このスクリプトは、大学のWeb時間割ページ（月間カレンダー表示）に挿入され、以下の2つの主要な機能を実行します。

UIの変更: ページフッターの「追加」ボタンの右隣に、「カレンダー出力」ボタンを動的に作成・配置します。

データ抽出: 新しく追加された「カレンダー出力」ボタンがクリックされた時、現在表示されている月の授業情報のみを抽出します。

抽出するデータ:

日にち (例: 2025-11-04)

開始時間 (例: 13:00)

終了時間 (例: 14:30)

授業名 (例: 電磁気学Ⅰ)

場所 (例: (情)1401講義室)

先生 (例: 許 宗焄)

抽出されたデータは、開発者コンソールにテーブル形式で出力されます。

2. UIの追加 (ボタンの作成)
フッターの「追加」ボタンを特定し、その直後に「カレンダー出力」ボタンを挿入します。

ターゲット（目印）となるボタン: 提供されたHTMLに基づき、onclick 属性に scheduleAdd という文字列を含む button 要素（＝「追加」ボタン）を検索します。

セレクタ: button[onclick*="scheduleAdd"]

作成するボタンの仕様: 「追加」ボタンと全く同じCSSクラス (c-btn c-btn-submit01) とHTML構造 (<span class="c-btn-link"><span class="c-btn-text">...</span></span>) を使用して、「カレンダー出力」ボタンをdocument.createElementで作成します。

挿入: Element.after() メソッドを使用し、「追加」ボタンの直後に作成したボタンを挿入します。

3. データ抽出のロジック
データ抽出処理 (scrapeCurrentMonthClasses) は、ページ読み込み時ではなく、「カレンダー出力」ボタンに紐付けられたクリックイベント (handleExport) によってトリガーされます。

ページと月の判別方法 (最重要)
カレンダーは当月以外の日にち（前月・次月）もグレーで表示しますが、これらの日付セル（<td>）には fc-day-other というクラスが付与されています。

ロジック:

すべての授業イベント（a.c-timetable-usage-guide-item-class）を取得します。

各イベントの親の <td> 要素を探します。

その <td> 要素が fc-day-other クラスを持っていない（＝当月である）ことを確認します。

fc-day-other クラスを持つイベントは無視します。

これにより、表示されている当月のデータのみを正確に抽出できます。

開始・終了時間の判別方法
授業の開始時間と終了時間は、イベントタイトル要素（.fc-event-title）内のテキストに含まれています。

HTMLの例: <div class="fc-event-title">電磁気学Ⅰ　３限 13:00-14:30　(情)1401講義室　許　宗焄　飯塚</div>

ロジック:

イベントタイトルテキストを全角スペース S で分割します。

2番目の要素（parts[1]）に時限と時間が含まれます (例: ３限 13:00-14:30)。

この文字列に対し、正規表現 (\d{1,2}:\d{2})-(\d{1,2}:\d{2}) を使用します。

これにより、13:00 (開始時間) と 14:30 (終了時間) を正確に抽出します。

出力ファイルは/home/user/workspace/KIT_LCU_Timetable/【2025-3Q】履修台本登録シート.csvを参照し
.csvで出力する
名前は[calendar_2025_11.csv]のように
